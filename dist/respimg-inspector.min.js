/*
 *  respimg-inspector - v0.1.1
 *  A javascript plugin to check responsive images in the browser.
 *  
 *
 *  Made by Florent Bourgeois
 *  Under MIT License
 */
!function(a,b,c){"use strict";var d,e,f={},g=!!b.querySelector&&!!a.addEventListener&&!!a.MutationObserver,h=[],i=[],j=[],k={selectors:null,classNamespace:"respimg-inspector-",wrapperId:"respimg-inspector-wrapper"},l=["span","em","strong","i","b","big","small","tt","abbr","script","br","hr","sub","sup","button","input","label","select","textarea","samp","var"],m=b.body,n=function(a,b,c){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.call(c,a[d],d,a);else for(var e=0,f=a.length;f>e;e++)b.call(c,a[e],e,a)},o=function(a,b){var c,d={};for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(d[c]=b[c]);return d},p=function(b,c,d){var e=d||a,f=!1,g=function(){f||(f=!0,r.disconnect(),requestAnimationFrame(function(){e.dispatchEvent(new CustomEvent(c)),f=!1}))};e.addEventListener(b,g)},q=function(b,c){return a.getComputedStyle(b,null).getPropertyValue(c)},r=new MutationObserver(function(a){a.forEach(function(){s()})}),s=function(){B();var c=t(),d=b.querySelectorAll(c);n(d,function(a){var b=w(a),c={el:a,img:b};("IMG"===c.el.nodeName||"cover"===q(c.el,"background-size"))&&(h.push(c),i.push(b))}),a.imagesLoaded(i,function(){n(h,function(a){var b=o(u(a.el),v(a.img));j.push(y(b)),r.observe(a.el,{attributes:!0})}),z(),A(),r.observe(m,{childList:!0})})},t=function(){if(d.selectors)return d.selectors;var a=l.map(function(a){return"*:not("+a+")"});return a.join()},u=function(a){var b=a.getBoundingClientRect();return{elTag:a.nodeName.toLowerCase(),elWidth:b.width,elHeight:b.height,elTop:b.top,elBottom:b.bottom,elLeft:b.left,elRight:b.right}},v=function(a){return{imgWidth:a.width,imgHeight:a.height,imgNaturalWidth:a.naturalWidth,imgNaturalHeight:a.naturalHeight,imgSizes:a.sizes}},w=function(a){var b;if("IMG"===a.nodeName)b=a;else if("none"!==q(a,"background-image")){var c=/^url\((['"]?)(.*)\1\)$/.exec(q(a,"background-image"));b=new Image,b.src=c[2]}return b},x=function(b){var c,e=a.devicePixelRatio;return c=b.elWidth*e<b.imgNaturalWidth||b.elHeight*e<b.imgNaturalHeight?"warning":b.elWidth*e>b.imgNaturalWidth||b.elHeight*e>b.imgNaturalHeight?"bad":"good",d.classNamespace+c},y=function(a){var c=q(m,"margin-top"),e=q(m,"margin-left"),f=m.getBoundingClientRect(),g=a.elTop-f.top,h=a.elLeft-f.left,i=b.createElement("div");return i.classList.add(d.classNamespace+"overlay"),i.style.position="absolute",i.style.width=a.elWidth+"px",i.style.height=a.elHeight+"px",i.style.top="calc("+g+"px + "+c+")",i.style.left="calc("+h+"px + "+e+")",i.classList.add(x(a)),n(a,function(a,b){i.dataset[b]=a}),i},z=function(){e=b.createElement("div"),e.id=d.wrapperId,e.style.position="absolute",e.style.top=0,e.style.bottom=0,e.style.left=0,e.style.right=0,e.style.zIndex=2147483647,m.appendChild(e)},A=function(){n(j,function(a){e.appendChild(a)})},B=function(){r.disconnect(),j.length&&n(j,function(a){a.remove()}),e!==c&&e.remove(),h=[],i=[],j=[]};f.init=function(b){g&&(d=o(k,b||{}),p("resize","optimizedResize"),a.addEventListener("optimizedResize",s),a.addEventListener("load",s))},"function"==typeof define&&define.amd?define([],function(){return f}):"undefined"!=typeof module&&module.exports?module.exports=f:a.respImgInspector=f}(window,document);